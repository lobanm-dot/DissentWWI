<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WWI Homefront: Civil Liberties Station</title>
    
    <!-- React & Tailwind Setup -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Playfair+Display:wght@700;900&family=Chomsky&display=swap" rel="stylesheet">
    
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #2c241b;
        }
        
        .font-courier { font-family: 'Courier Prime', monospace; }
        .font-playfair { font-family: 'Playfair Display', serif; }
        
        .newspaper-container {
            background-color: #f3f2eb;
            color: #2f2f2f;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23d1d1c9' fill-opacity='0.4' fill-rule='evenodd'/%3E%3C/svg%3E");
        }

        .bg-vintage-pattern {
            background-color: #2c241b;
            background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h40v40H0V0zm20 20h20v20H20V20zM0 20h20v20H0V20z' fill='%233e3226' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
        }

        .vintage-paper {
            background-color: #f4e4bc;
            background-image: repeating-linear-gradient(to right, transparent 0 100%, #e6d5ac 100% 101%);
            box-shadow: inset 0 0 40px rgba(0,0,0,0.1), 5px 5px 15px rgba(0,0,0,0.5);
            border: 1px solid #d4c59a;
        }

        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            background: #000;
            cursor: pointer;
            border: 2px solid #d4c59a;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .interactive-word {
            border-bottom: 2px dashed #b91c1c;
            cursor: pointer;
            transition: all 0.2s;
        }
        .interactive-word:hover {
            background-color: #fee2e2;
        }
        .word-found {
            background-color: #b91c1c;
            color: white;
            border-bottom: none;
            padding: 0 4px;
            border-radius: 2px;
            cursor: default;
        }

        .term-card {
            transition: all 0.2s;
            cursor: pointer;
        }
        .term-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .term-selected {
            background-color: #fee2e2;
            border-color: #b91c1c;
            transform: scale(1.02);
        }
        .term-matched {
            background-color: #dcfce7;
            border-color: #15803d;
            color: #14532d;
            cursor: default;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Case Data ---
        const scenarios = [
            {
                id: 1,
                title: "Eugene V. Debs",
                subTitle: "The Canton Speech",
                img: "Case1.png",
                context: "Eugene V. Debs, a five-time presidential candidate for the Socialist Party, traveled to Canton, Ohio to visit three fellow socialists in prison. He delivered a fiery speech to a crowd of 1,200 in a public park. In it, he carefully avoided directly inciting violence, but heavily criticized the U.S. government, the draft, and the war as a capitalist venture, famously stating the 'master class' declares wars while the 'subject class' fights them.",
                charges: "Charged with 10 counts of violating the Espionage Act for 'attempting to cause insubordination in the military' and 'obstructing recruitment'.",
                prosecution: "He is obstructing recruitment! He told the crowd they are 'fit for something better than cannon fodder.' This discourages young men from enlisting. He is a danger to our military success. Words that might be harmless in peace become dangerous sparks in a powder keg during war.",
                defense: "He never explicitly told anyone to break the law. He is critiquing capitalism and war in general. The First Amendment protects political dissent, especially during wartime when we need it most. To silence a man for his political philosophy is to dismantle the very democracy we claim to be fighting for.",
                historicalRuling: "Illegal",
                outcome: "Sentenced to 10 years in prison.",
                reasoning: "The Supreme Court upheld the conviction. They argued his words had the 'natural tendency' to obstruct the draft.",
                libertyImpact: -15
            },
            {
                id: 2,
                title: "The Hofer Brothers",
                subTitle: "The Hutterite Martyrs",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/Hutterites.jpg/640px-Hutterites.jpg", 
                context: "Joseph and Michael Hofer were Hutterites, a Christian sect living in communal colonies in South Dakota who believe in absolute pacifism. When drafted, they reported to camp but refused to wear military uniforms, pick up weapons, or even perform non-combat work, believing any support of the 'war machine' violated Jesus's teachings. Their refusal was seen not just as religious devotion, but as defiance of federal law.",
                charges: "Court-martialed for 'disobeying lawful orders' from a superior officer under the Articles of War.",
                prosecution: "A soldier cannot choose which orders to follow. Refusing to wear the uniform is insubordination. If we allow this, discipline in the entire army crumbles. Every exemption weakens our line. They enjoy the protection of our flag but refuse to defend it.",
                defense: "These men are not spies; they are religious pacifists. They have lived in America for peace. Forcing them to violate their conscience and religion is tyranny, not defense. They are willing to farm or help, but they cannot wear the uniform of death.",
                historicalRuling: "Illegal",
                outcome: "Court-martialed and sent to Alcatraz/Leavenworth. Two brothers died from mistreatment.",
                reasoning: "The military viewed conscientious objection as a crime equivalent to desertion or sedition during the war crisis.",
                libertyImpact: -25
            },
            {
                id: 3,
                title: "Emma Goldman",
                subTitle: "No Conscription League",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Emma_Goldman_standing_on_a_street_car_1916.jpg/470px-Emma_Goldman_standing_on_a_street_car_1916.jpg",
                context: "Emma Goldman, a fierce anarchist, launched the 'No Conscription League' to oppose the draft, which she called a violation of the 13th Amendment's ban on involuntary servitude. At massive rallies in New York, she stopped short of telling men to dodge the draft directly, but handed out manifestos arguing that conscription was 'the cemetery of liberty' and that citizens had a moral right to resist.",
                charges: "Charged with 'conspiracy to induce persons not to register' for the draft under the Selective Service Act.",
                prosecution: "She is organizing a conspiracy to induce men not to register! She calls the draft 'state tyranny.' This is a direct attempt to sabotage the Selective Service Act. She is not debating; she is actively counseling young men to commit a crime against their country.",
                defense: "She is expressing an opinion on a law. She believes the draft violates the 13th Amendment (involuntary servitude). This is protected political speech, not a physical blockade. If we cannot debate the legality of a law, we are subjects, not citizens.",
                historicalRuling: "Illegal",
                outcome: "Sentenced to 2 years, fined $10,000, and deported to Russia.",
                reasoning: "The court ruled that organizing to counsel others to break the law is not protected speech.",
                libertyImpact: -20
            },
            {
                id: 4,
                title: "Charles Schenck",
                subTitle: "The Pamphleteer",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Schenck_v._United_States_pamphlet.jpg/480px-Schenck_v._United_States_pamphlet.jpg",
                context: "Charles Schenck was the General Secretary of the Socialist Party in Philadelphia. To protest the draft, he printed 15,000 leaflets titled 'Long Live the Constitution of the United States.' These were mailed directly to men who had just been drafted. The pamphlets didn't call for violence, but urged men to 'assert your rights' and resist the 'intimidation' of the draft board, comparing a conscript to a convict.",
                charges: "Charged with 'conspiracy to violate the Espionage Act' by causing insubordination in the military and obstructing recruitment.",
                prosecution: "He targeted draftees specifically! This isn't just a speech; it's an attempt to cause insubordination in the military. It creates a 'Clear and Present Danger'. You cannot falsely shout fire in a crowded theater; you cannot shout rebellion in a recruited army.",
                defense: "The pamphlet only urged peaceful resistance and repeal of the act. It quoted the Constitution! If we can't quote the Constitution during war, do we have a Constitution? He is petitioning the government for redress of grievances, a fundamental right.",
                historicalRuling: "Illegal",
                outcome: "Conviction upheld by Supreme Court (9-0).",
                reasoning: "Justice Holmes created the 'Clear and Present Danger' test. Free speech does not protect a man falsely shouting fire in a theater.",
                libertyImpact: -20
            },
            {
                id: 5,
                title: "Robert Goldstein",
                subTitle: "The Spirit of '76",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Spirit_of_76_poster.jpg/480px-Spirit_of_76_poster.jpg",
                context: "Robert Goldstein produced a lavish silent film, 'The Spirit of '76', depicting the American Revolution. The movie included historically accurate but violent scenes of British soldiers bayoneting women and children during the Wyoming Valley Massacre. However, because the U.S. had just entered WWI as an *ally* of Britain, federal agents seized the film. They argued that showing British atrocities—even from 140 years ago—would incite hatred against an ally.",
                charges: "Charged with violating the Espionage Act for 'attempting to cause insubordination, mutiny, and refusal of duty' in the military.",
                prosecution: "This film sows discord! The British are now our allies. Showing them as villains will make Americans hate them and help the Germans. It is enemy propaganda disguised as history. It is calculated to make us fight our friends instead of our enemies.",
                defense: "It's a historical movie about 1776! It depicts actual events. We cannot censor history just because our alliances have changed. This is art, not treason. The truth of the American Revolution does not change because of European politics today.",
                historicalRuling: "Illegal",
                outcome: "Sentenced to 10 years in federal prison.",
                reasoning: "The court ruled the film was 'calculated to foment disloyalty' and aid the German enemy by dividing the Allies.",
                libertyImpact: -30
            }
        ];

        // --- Vocabulary Data ---
        const vocabTerms = [
            { term: "Obstruct", id: "obstruct" },
            { term: "Disloyal", id: "disloyal" },
            { term: "Abusive", id: "abusive" }
        ];

        const vocabDefinitions = [
            { id: "abusive", text: "Extremely offensive, insulting, or harmful language." },
            { id: "obstruct", text: "To intentionally block, stop, or delay an action (like recruitment)." },
            { id: "disloyal", text: "Unfaithful to one's government; showing a lack of allegiance." }
        ];

        function App() {
            const [phase, setPhase] = useState('newspaper'); 
            const [currentScenarioIndex, setCurrentScenarioIndex] = useState(0);
            const [libertyMeter, setLibertyMeter] = useState(100);
            const [score, setScore] = useState(0);
            const [studentRewrite, setStudentRewrite] = useState("");
            const [showRewriteReveal, setShowRewriteReveal] = useState(false);
            
            const [sliderValue, setSliderValue] = useState(50);
            const [selectedTerm, setSelectedTerm] = useState(null);
            const [matchedPairs, setMatchedPairs] = useState([]); 
            const [finalReflection, setFinalReflection] = useState("");

            const currentScenario = scenarios[currentScenarioIndex];

            // --- Actions ---
            const handleTermClick = (id) => {
                if (matchedPairs.includes(id)) return;
                setSelectedTerm(id);
            };

            const handleDefClick = (id) => {
                if (matchedPairs.includes(id)) return;
                if (selectedTerm === id) {
                    setMatchedPairs([...matchedPairs, id]);
                    setSelectedTerm(null);
                } else {
                    setSelectedTerm(null);
                }
            };

            const submitVerdict = () => {
                const isGuiltyVerdict = sliderValue > 50;
                const isHistoricallyIllegal = currentScenario.historicalRuling === "Illegal";
                
                let points = 0;
                if (isGuiltyVerdict && isHistoricallyIllegal) points = 1;
                if (!isGuiltyVerdict && !isHistoricallyIllegal) points = 1; 
                
                setScore(s => s + points);
                
                if (isGuiltyVerdict) {
                    setLibertyMeter(prev => Math.max(0, prev + currentScenario.libertyImpact));
                }
                setPhase('result');
            };

            const nextCase = () => {
                if (currentScenarioIndex < scenarios.length - 1) {
                    setCurrentScenarioIndex(prev => prev + 1);
                    setSliderValue(50); 
                    setPhase('game');
                } else {
                    setPhase('levelup');
                }
            };

            const resetGame = () => {
                setPhase('newspaper');
                setCurrentScenarioIndex(0);
                setLibertyMeter(100);
                setScore(0);
                setSliderValue(50);
                setStudentRewrite("");
                setShowRewriteReveal(false);
                setMatchedPairs([]);
                setSelectedTerm(null);
                setFinalReflection("");
            };

            // --- Component Renders ---
            
            const Newspaper = () => (
                <div className="min-h-screen p-4 md:p-8 newspaper-container flex items-center justify-center">
                    <div className="max-w-4xl w-full bg-[#fffdf0] text-black shadow-2xl p-6 md:p-12 border-t-8 border-black">
                        <div className="text-center border-b-4 border-double border-black pb-4 mb-6">
                            <div className="text-xs font-bold uppercase tracking-[0.5em] mb-2 text-stone-600">May 16, 1918 • Late Edition • Price 2 Cents</div>
                            <h1 className="font-playfair text-6xl md:text-8xl font-black uppercase leading-none mb-2">The War Gazette</h1>
                            <div className="w-full h-1 bg-black mb-1"></div>
                            <div className="w-full h-0.5 bg-black"></div>
                        </div>

                        <div className="text-center mb-8">
                            <h2 className="font-playfair text-5xl md:text-6xl font-black uppercase leading-tight mb-2">Sedition Act Signed!</h2>
                            <h3 className="font-serif text-2xl italic text-stone-700">Criticism of Government Now Punishable by 20 Years in Prison</h3>
                        </div>

                        <div className="grid md:grid-cols-3 gap-8">
                            <div className="md:col-span-2">
                                <div className="text-lg leading-relaxed font-serif mb-6 text-justify">
                                    <p className="mb-4">
                                        Washington D.C. — In a move to protect the war effort, Congress has passed two sweeping laws. 
                                        The <strong className="font-sans">Espionage Act (1917)</strong> makes it a crime to willfully <span className="font-bold underline decoration-red-800">obstruct</span> military recruitment.
                                    </p>
                                    <p>
                                        The new <strong className="font-sans">Sedition Act (1918)</strong> goes further, forbidding any <span className="font-bold underline decoration-red-800">disloyal</span>, profane, scurrilous, or <span className="font-bold underline decoration-red-800">abusive</span> language about the United States government, its flag, or its armed forces.
                                    </p>
                                </div>

                                <div className="bg-red-50 border border-red-200 p-6 rounded-sm">
                                    <h4 className="font-bold text-red-900 uppercase tracking-wider text-sm mb-4 border-b border-red-200 pb-2">Judicial Qualification Task</h4>
                                    <p className="text-sm text-red-800 mb-4">
                                        Prove you can interpret the law. Match the term on the left to its correct legal definition on the right.
                                    </p>
                                    
                                    <div className="grid grid-cols-2 gap-4">
                                        <h5 className="font-bold text-xs uppercase text-stone-500 mb-2">Legal Term</h5>
                                        <h5 className="font-bold text-xs uppercase text-stone-500 mb-2">Definition</h5>
                                        
                                        {vocabTerms.map((termItem, index) => {
                                            const defItem = vocabDefinitions[index];
                                            return (
                                                <React.Fragment key={termItem.id}>
                                                    <div 
                                                        onClick={() => handleTermClick(termItem.id)}
                                                        className={`p-3 border-2 rounded text-sm font-bold text-center flex items-center justify-center h-full cursor-pointer
                                                            ${matchedPairs.includes(termItem.id) ? 'term-matched' : 'term-card bg-white border-stone-300'}
                                                            ${selectedTerm === termItem.id ? 'term-selected' : ''}
                                                        `}
                                                    >
                                                        {termItem.term} {matchedPairs.includes(termItem.id) && "✓"}
                                                    </div>

                                                    <div 
                                                        onClick={() => handleDefClick(defItem.id)}
                                                        className={`p-3 border-2 rounded text-xs leading-tight flex items-center h-full cursor-pointer
                                                            ${matchedPairs.includes(defItem.id) ? 'term-matched' : 'term-card bg-white border-stone-300'}
                                                        `}
                                                    >
                                                        {defItem.text}
                                                    </div>
                                                </React.Fragment>
                                            );
                                        })}
                                    </div>
                                </div>

                                {matchedPairs.length === 3 ? (
                                    <div className="animate-fade-in mt-8 text-center">
                                        <p className="font-bold text-green-800 mb-2">✓ QUALIFICATION COMPLETE</p>
                                        <button 
                                            onClick={() => setPhase('intro')}
                                            className="bg-black text-white text-xl font-bold px-8 py-4 uppercase hover:bg-stone-800 transition shadow-lg w-full"
                                        >
                                            Take Judicial Oath & Begin &rarr;
                                        </button>
                                    </div>
                                ) : (
                                    <div className="mt-8 text-center text-stone-400 font-bold italic text-sm">
                                        Match all 3 terms to proceed...
                                    </div>
                                )}
                            </div>

                            <div className="md:col-span-1 border-l-2 border-stone-300 pl-8 hidden md:block">
                                <div className="mb-6">
                                    <h4 className="font-sans font-bold uppercase border-b-2 border-black mb-2">The Justification</h4>
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Thomas_Watt_Gregory_1913.jpg/480px-Thomas_Watt_Gregory_1913.jpg" className="w-full grayscale mb-2 sepia opacity-80" alt="Attorney General" />
                                    <p className="text-xs text-stone-500 mb-2">Attorney General Thomas Gregory</p>
                                    <blockquote className="font-serif italic text-lg leading-tight">
                                        "May God have mercy on them, for they need expect none from an outraged people and an <span className="font-bold">avenging government</span>."
                                    </blockquote>
                                </div>
                                <div className="bg-stone-200 p-4 text-center mt-8">
                                    <h5 className="font-bold uppercase text-sm mb-2">Liberty Bonds</h5>
                                    <div className="text-4xl font-black mb-1">100%</div>
                                    <div className="text-xs">Americanism Required</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );

            const Intro = () => (
                <div className="flex flex-col items-center justify-center min-h-screen text-center p-8 bg-vintage-pattern font-courier text-stone-900 animate-fade-in">
                    <div className="vintage-paper p-12 max-w-2xl transform rotate-1 rounded-sm shadow-2xl">
                        <h1 className="font-playfair text-4xl mb-4 text-stone-800 uppercase tracking-widest border-b-4 border-black pb-2">Judicial Orders</h1>
                        <div className="mb-6">
                            <span className="bg-black text-white px-3 py-1 text-sm font-bold uppercase">Authorized Personnel Only</span>
                        </div>
                        <p className="text-lg leading-relaxed mb-6 text-left">
                            You have reviewed the Sedition Act. As a newly appointed Federal Judge, your duty is to enforce these laws without hesitation.
                        </p>
                        <p className="italic text-sm mb-8 text-stone-600">Listen to the arguments. Weigh the security of the nation against the liberty of the individual.</p>
                        <button 
                            onClick={() => setPhase('game')}
                            className="bg-red-900 text-amber-50 px-8 py-3 text-xl font-bold uppercase hover:bg-red-800 transition shadow-lg border-2 border-black cursor-pointer"
                        >
                            Enter the Courtroom
                        </button>
                    </div>
                </div>
            );

            const Meter = () => (
                <div className="fixed top-4 right-4 z-10 w-64 vintage-paper p-3 border-2 border-black shadow-xl hidden md:block font-courier">
                    <div className="flex justify-between text-xs font-bold uppercase mb-1">
                        <span>Totalitarianism</span>
                        <span>Anarchy</span>
                    </div>
                    <div className="text-center font-bold text-lg mb-1 font-playfair">LIBERTY METER</div>
                    <div className="w-full bg-stone-300 h-6 border border-black relative">
                        <div 
                            className={`h-full transition-all duration-1000 ${libertyMeter > 50 ? 'bg-green-700' : 'bg-red-700'}`} 
                            style={{ width: `${libertyMeter}%` }}
                        ></div>
                    </div>
                    <div className="text-xs text-center mt-1 text-stone-600">{libertyMeter}% Civil Liberties Remaining</div>
                </div>
            );

            const GameScreen = () => (
                <div className="min-h-screen flex items-center justify-center py-12 px-4 relative bg-vintage-pattern font-courier text-stone-900">
                    <Meter />
                    <div className="vintage-paper max-w-6xl w-full p-6 md:p-10 relative min-h-[700px] flex flex-col shadow-2xl">
                        {/* Header */}
                        <div className="border-b-2 border-black pb-4 mb-6 flex flex-wrap justify-between items-end gap-2">
                            <div>
                                <h2 className="text-sm uppercase tracking-widest text-stone-500">Case File #{currentScenario.id}</h2>
                                <h1 className="text-3xl font-playfair font-bold">{currentScenario.title}</h1>
                                <h2 className="text-lg italic font-serif text-stone-600">{currentScenario.subTitle}</h2>
                            </div>
                            <div className="text-right">
                                <div className="text-4xl font-black font-playfair opacity-20">VS</div>
                            </div>
                        </div>

                        {/* Top Section: Evidence */}
                        <div className="grid md:grid-cols-2 gap-8 mb-8">
                            <div className="flex items-center justify-center bg-stone-100 p-4 border border-stone-300">
                                 <img 
                                    src={currentScenario.img} 
                                    alt={currentScenario.title} 
                                    className="max-h-80 w-auto object-contain shadow-md border-2 border-stone-400" 
                                />
                            </div>
                            <div className="flex flex-col justify-center">
                                <h4 className="font-bold uppercase text-sm tracking-widest text-stone-500 mb-2 border-b border-stone-300 pb-1">Context</h4>
                                <p className="text-lg mb-6 leading-relaxed font-serif">{currentScenario.context}</p>
                                
                                <div className="bg-red-50 p-4 border-l-4 border-red-800 text-left">
                                    <h4 className="font-bold uppercase text-xs tracking-widest text-red-900 mb-1">Official Charges:</h4>
                                    <p className="text-base font-bold text-red-900">{currentScenario.charges}</p>
                                </div>
                            </div>
                        </div>

                        {/* Middle Section: The Arguments */}
                        <div className="grid md:grid-cols-2 gap-8 mb-8 flex-grow">
                            {/* Defense */}
                            <div className="bg-white p-6 border-l-4 border-blue-800 shadow-sm flex flex-col">
                                <h3 className="font-bold text-blue-900 mb-4 uppercase tracking-wide border-b border-blue-200 pb-2 text-xl">Defense Argument</h3>
                                <p className="font-serif text-lg leading-relaxed flex-grow italic text-stone-800">"{currentScenario.defense}"</p>
                            </div>

                            {/* Prosecution */}
                            <div className="bg-white p-6 border-r-4 border-red-800 shadow-sm flex flex-col text-right">
                                <h3 className="font-bold text-red-900 mb-4 uppercase tracking-wide border-b border-red-200 pb-2 text-xl">Prosecution Argument</h3>
                                <p className="font-serif text-lg leading-relaxed flex-grow italic text-stone-800">"{currentScenario.prosecution}"</p>
                            </div>
                        </div>

                        {/* Bottom Section: The Verdict */}
                        <div className="bg-stone-100 p-6 border-t-2 border-stone-300">
                            <h4 className="font-bold uppercase text-xs tracking-widest text-center mb-4 text-stone-500">Jurisprudence Scale</h4>
                            <div className="relative max-w-2xl mx-auto">
                                <div className="flex justify-between text-sm font-bold uppercase mb-2">
                                    <span className="text-blue-800">Protected Speech</span>
                                    <span className="text-red-800">Criminal Sedition</span>
                                </div>
                                <input 
                                    type="range" 
                                    min="0" 
                                    max="100" 
                                    value={sliderValue} 
                                    onChange={(e) => setSliderValue(Number(e.target.value))}
                                    className="w-full h-4 bg-gradient-to-r from-blue-200 via-stone-300 to-red-200 rounded-lg appearance-none cursor-pointer border border-stone-400 slider-thumb"
                                />
                                <div className="flex justify-center mt-4">
                                    <button 
                                        onClick={submitVerdict}
                                        className="bg-black text-white py-3 px-12 font-bold uppercase tracking-widest hover:bg-stone-800 shadow-lg border-2 border-transparent hover:border-black transition text-lg"
                                    >
                                        Deliver Verdict
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );

            const ResultScreen = () => (
                <div className="min-h-screen flex items-center justify-center py-12 px-4 relative bg-vintage-pattern font-courier text-stone-900">
                    <Meter />
                    <div className="vintage-paper max-w-3xl w-full p-8 relative flex flex-col shadow-2xl animate-fade-in border-4 border-double border-stone-600">
                        <div className="text-center mb-6">
                            <h2 className="text-sm uppercase tracking-widest text-stone-500 mb-2">Historical Reality Check</h2>
                            <h1 className="font-playfair text-4xl font-bold mb-4">{currentScenario.title}</h1>
                            <div className={`inline-block px-6 py-2 border-4 text-2xl font-black uppercase transform -rotate-2 ${
                                currentScenario.historicalRuling === 'Illegal' ? 'border-red-800 text-red-800' : 'border-green-800 text-green-800'
                            }`}>
                                Verdict: {currentScenario.historicalRuling}
                            </div>
                        </div>

                        <div className="bg-white p-6 border border-stone-300 shadow-inner mb-6">
                            <h3 className="font-bold uppercase text-xs mb-2 text-stone-400">The Outcome</h3>
                            <p className="text-lg font-serif mb-4">{currentScenario.outcome}</p>
                            <h3 className="font-bold uppercase text-xs mb-2 text-stone-400">Legal Reasoning</h3>
                            <p className="text-md leading-relaxed">{currentScenario.reasoning}</p>
                        </div>

                        <div className="flex justify-between items-center bg-stone-200 p-4 mb-6">
                            <div className="text-sm">
                                <strong>Your Ruling:</strong> {sliderValue < 50 ? "Protected Speech" : "Criminal Sedition"}
                            </div>
                            <div className="text-sm">
                                <strong>Match:</strong> {((sliderValue > 50 && currentScenario.historicalRuling === 'Illegal') || (sliderValue <= 50 && currentScenario.historicalRuling !== 'Illegal')) ? "Yes (+1 Score)" : "No"}
                            </div>
                        </div>

                        <button 
                            onClick={nextCase}
                            className="w-full bg-black text-white py-4 font-bold uppercase hover:bg-stone-800 shadow-lg"
                        >
                            Next Case &rarr;
                        </button>
                    </div>
                </div>
            );

            const LevelUp = () => (
                <div className="min-h-screen flex items-center justify-center py-12 px-4 bg-vintage-pattern font-courier text-stone-900">
                    <div className="vintage-paper max-w-3xl w-full p-10 shadow-2xl">
                        <div className="flex justify-between items-center mb-6 border-b-2 border-black pb-4">
                            <h1 className="font-playfair text-4xl">Final Verdict</h1>
                            <div className="text-right">
                                <p className="text-sm font-bold">ACCURACY SCORE</p>
                                <p className="text-2xl">{score} / {scenarios.length}</p>
                            </div>
                        </div>

                        <div className="mb-8">
                            <p className="text-lg mb-4">
                                In <em>Schenck v. United States</em>, Justice Oliver Wendell Holmes Jr. created the 
                                <strong> "Clear and Present Danger"</strong> test.
                            </p>
                            <div className="bg-stone-200 p-6 border-l-4 border-red-800 mb-6">
                                <h3 className="font-bold text-red-900 mb-2">FINAL CHALLENGE:</h3>
                                <p>Rewrite the "Clear and Present Danger" standard in your own words. How would you explain to a 9th grader when the government is allowed to stop someone from speaking?</p>
                            </div>

                            <textarea 
                                className="w-full p-4 bg-white border-2 border-stone-400 font-handwriting text-lg shadow-inner focus:outline-none focus:border-black transition"
                                rows="4"
                                placeholder="Start typing here... For example: Speech should only be illegal if..."
                                value={studentRewrite}
                                onChange={(e) => setStudentRewrite(e.target.value)}
                            ></textarea>
                        </div>

                        {!showRewriteReveal ? (
                            <button 
                                onClick={() => setShowRewriteReveal(true)}
                                disabled={studentRewrite.length < 10}
                                className="bg-blue-900 text-white px-8 py-3 font-bold disabled:opacity-50 hover:bg-blue-800 cursor-pointer"
                            >
                                Submit & Compare
                            </button>
                        ) : (
                            <div className="animate-fade-in mt-6">
                                <h3 className="font-bold text-stone-500 text-sm uppercase mb-2">Original Text (Justice Holmes):</h3>
                                <div className="bg-white p-6 border border-stone-300 font-serif italic mb-6">
                                    "The question in every case is whether the words used are used in such circumstances and are of such a nature as to create a <strong>clear and present danger</strong> that they will bring about the substantive evils that Congress has a right to prevent."
                                </div>
                                <div className="bg-green-100 p-4 border border-green-600 text-green-900 mb-6">
                                    <strong>Teacher Feedback:</strong> Excellent work. Notice how vague "substantive evils" is? This ambiguity allowed the government to arrest many people during WWI who simply disagreed with the war.
                                </div>
                                <button 
                                    onClick={() => setPhase('reflection')}
                                    className="w-full bg-black text-white text-xl font-bold px-8 py-4 uppercase hover:bg-stone-800 transition shadow-lg"
                                >
                                    Next: Final Reflection &rarr;
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );

            const Reflection = () => (
                <div className="min-h-screen flex items-center justify-center py-12 px-4 bg-vintage-pattern font-courier text-stone-900">
                    <div className="vintage-paper max-w-3xl w-full p-10 shadow-2xl">
                        <h1 className="font-playfair text-4xl mb-6 border-b-2 border-black pb-4 text-center">Final Reflection</h1>
                        <div className="mb-6 flex justify-center">
                            <div className="border-4 border-stone-800 p-2 bg-white transform -rotate-1">
                                <img 
                                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Rogers_-_Must_Liberty%27s_Light_Go_Out.jpg/470px-Rogers_-_Must_Liberty%27s_Light_Go_Out.jpg" 
                                    alt="Political Cartoon: Must Liberty's Light Go Out?" 
                                    className="max-h-[300px] object-contain sepia"
                                />
                                <p className="text-center text-xs mt-2 italic text-stone-500">
                                    "Must Liberty's Light Go Out?" (W.A. Rogers, 1917)
                                </p>
                            </div>
                        </div>

                        <div className="mb-8">
                            <div className="bg-stone-200 p-6 border-l-4 border-black mb-6">
                                <h3 className="font-bold text-stone-900 mb-2 uppercase">Your Opinion:</h3>
                                <p className="font-serif text-lg leading-relaxed">
                                    Based on what you've seen today (The Espionage Act, The Sedition Act, and the imprisonment of dissenters), answer the following:
                                </p>
                                <p className="font-bold mt-2">
                                    Should the government be allowed to infringe on civil liberties like freedom of speech during times of crisis? Why or why not?
                                </p>
                            </div>

                            <textarea 
                                className="w-full p-4 bg-white border-2 border-stone-400 font-handwriting text-lg shadow-inner focus:outline-none focus:border-black transition"
                                rows="6"
                                placeholder="Write your reflection here..."
                                value={finalReflection}
                                onChange={(e) => setFinalReflection(e.target.value)}
                            ></textarea>
                        </div>

                        <button 
                            onClick={resetGame}
                            disabled={finalReflection.length < 10}
                            className="w-full bg-red-900 text-white text-xl font-bold px-8 py-4 uppercase hover:bg-red-800 transition shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            Submit & Finish Simulation
                        </button>
                    </div>
                </div>
            );

            return (
                <div className="w-full h-full">
                    {phase === 'newspaper' && <Newspaper />}
                    {phase === 'intro' && <Intro />}
                    {phase === 'game' && <GameScreen />}
                    {phase === 'result' && <ResultScreen />}
                    {phase === 'levelup' && <LevelUp />}
                    {phase === 'reflection' && <Reflection />}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
        .interactive-word {
            border-bottom: 2px dashed #b91c1c;
            cursor: pointer;
            transition: all 0.2s;
        }
        .interactive-word:hover {
            background-color: #fee2e2;
        }
        .word-found {
            background-color: #b91c1c;
            color: white;
            border-bottom: none;
            padding: 0 4px;
            border-radius: 2px;
            cursor: default;
        }

        .term-card {
            transition: all 0.2s;
            cursor: pointer;
        }
        .term-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .term-selected {
            background-color: #fee2e2;
            border-color: #b91c1c;
            transform: scale(1.02);
        }
        .term-matched {
            background-color: #dcfce7;
            border-color: #15803d;
            color: #14532d;
            cursor: default;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Case Data ---
        const scenarios = [
            {
                id: 1,
                title: "Eugene V. Debs",
                subTitle: "The Canton Speech",
                img: "Case1.png",
                context: "Eugene V. Debs, a five-time presidential candidate for the Socialist Party, traveled to Canton, Ohio to visit three fellow socialists in prison. He delivered a fiery speech to a crowd of 1,200 in a public park. In it, he carefully avoided directly inciting violence, but heavily criticized the U.S. government, the draft, and the war as a capitalist venture, famously stating the 'master class' declares wars while the 'subject class' fights them.",
                charges: "Charged with 10 counts of violating the Espionage Act for 'attempting to cause insubordination in the military' and 'obstructing recruitment'.",
                prosecution: "He is obstructing recruitment! He told the crowd they are 'fit for something better than cannon fodder.' This discourages young men from enlisting. He is a danger to our military success.",
                defense: "He never explicitly told anyone to break the law. He is critiquing capitalism and war in general. The First Amendment protects political dissent, especially during wartime when we need it most.",
                historicalRuling: "Illegal",
                outcome: "Sentenced to 10 years in prison.",
                reasoning: "The Supreme Court upheld the conviction. They argued his words had the 'natural tendency' to obstruct the draft.",
                libertyImpact: -15
            },
            {
                id: 2,
                title: "The Hofer Brothers",
                subTitle: "The Hutterite Martyrs",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/Hutterites.jpg/640px-Hutterites.jpg", 
                context: "Joseph and Michael Hofer were Hutterites, a Christian sect living in communal colonies in South Dakota who believe in absolute pacifism. When drafted, they reported to camp but refused to wear military uniforms, pick up weapons, or even perform non-combat work, believing any support of the 'war machine' violated Jesus's teachings. Their refusal was seen not just as religious devotion, but as defiance of federal law.",
                charges: "Court-martialed for 'disobeying lawful orders' from a superior officer under the Articles of War.",
                prosecution: "A soldier cannot choose which orders to follow. Refusing to wear the uniform is insubordination. If we allow this, discipline in the entire army crumbles.",
                defense: "These men are not spies; they are religious pacifists. They have lived in America for peace. Forcing them to violate their conscience and religion is tyranny, not defense.",
                historicalRuling: "Illegal",
                outcome: "Court-martialed and sent to Alcatraz/Leavenworth. Two brothers died from mistreatment.",
                reasoning: "The military viewed conscientious objection as a crime equivalent to desertion or sedition during the war crisis.",
                libertyImpact: -25
            },
            {
                id: 3,
                title: "Emma Goldman",
                subTitle: "No Conscription League",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Emma_Goldman_standing_on_a_street_car_1916.jpg/470px-Emma_Goldman_standing_on_a_street_car_1916.jpg",
                context: "Emma Goldman, a fierce anarchist, launched the 'No Conscription League' to oppose the draft, which she called a violation of the 13th Amendment's ban on involuntary servitude. At massive rallies in New York, she stopped short of telling men to dodge the draft directly, but handed out manifestos arguing that conscription was 'the cemetery of liberty' and that citizens had a moral right to resist.",
                charges: "Charged with 'conspiracy to induce persons not to register' for the draft under the Selective Service Act.",
                prosecution: "She is organizing a conspiracy to induce men not to register! She calls the draft 'state tyranny.' This is a direct attempt to sabotage the Selective Service Act.",
                defense: "She is expressing an opinion on a law. She believes the draft violates the 13th Amendment (involuntary servitude). This is protected political speech, not a physical blockade.",
                historicalRuling: "Illegal",
                outcome: "Sentenced to 2 years, fined $10,000, and deported to Russia.",
                reasoning: "The court ruled that organizing to counsel others to break the law is not protected speech.",
                libertyImpact: -20
            },
            {
                id: 4,
                title: "Charles Schenck",
                subTitle: "The Pamphleteer",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Schenck_v._United_States_pamphlet.jpg/480px-Schenck_v._United_States_pamphlet.jpg",
                context: "Charles Schenck was the General Secretary of the Socialist Party in Philadelphia. To protest the draft, he printed 15,000 leaflets titled 'Long Live the Constitution of the United States.' These were mailed directly to men who had just been drafted. The pamphlets didn't call for violence, but urged men to 'assert your rights' and resist the 'intimidation' of the draft board, comparing a conscript to a convict.",
                charges: "Charged with 'conspiracy to violate the Espionage Act' by causing insubordination in the military and obstructing recruitment.",
                prosecution: "He targeted draftees specifically! This isn't just a speech; it's an attempt to cause insubordination in the military. It creates a 'Clear and Present Danger'.",
                defense: "The pamphlet only urged peaceful resistance and repeal of the act. It quoted the Constitution! If we can't quote the Constitution during war, do we have a Constitution?",
                historicalRuling: "Illegal",
                outcome: "Conviction upheld by Supreme Court (9-0).",
                reasoning: "Justice Holmes created the 'Clear and Present Danger' test. Free speech does not protect a man falsely shouting fire in a theater.",
                libertyImpact: -20
            },
            {
                id: 5,
                title: "Robert Goldstein",
                subTitle: "The Spirit of '76",
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Spirit_of_76_poster.jpg/480px-Spirit_of_76_poster.jpg",
                context: "Robert Goldstein produced a lavish silent film, 'The Spirit of '76', depicting the American Revolution. The movie included historically accurate but violent scenes of British soldiers bayoneting women and children during the Wyoming Valley Massacre. However, because the U.S. had just entered WWI as an *ally* of Britain, federal agents seized the film. They argued that showing British atrocities—even from 140 years ago—would incite hatred against an ally.",
                charges: "Charged with violating the Espionage Act for 'attempting to cause insubordination, mutiny, and refusal of duty' in the military.",
                prosecution: "This film sows discord! The British are now our allies. Showing them as villains will make Americans hate them and help the Germans. It is enemy propaganda.",
                defense: "It's a historical movie about 1776! It depicts actual events. We cannot censor history just because our alliances have changed. This is art, not treason.",
                historicalRuling: "Illegal",
                outcome: "Sentenced to 10 years in federal prison.",
                reasoning: "The court ruled the film was 'calculated to foment disloyalty' and aid the German enemy by dividing the Allies.",
                libertyImpact: -30
            }
        ];

        // --- Vocabulary Data ---
        const vocabTerms = [
            { term: "Obstruct", id: "obstruct" },
            { term: "Disloyal", id: "disloyal" },
            { term: "Abusive", id: "abusive" }
        ];

        const vocabDefinitions = [
            { id: "abusive", text: "Extremely offensive, insulting, or harmful language." },
            { id: "obstruct", text: "To intentionally block, stop, or delay an action (like recruitment)." },
            { id: "disloyal", text: "Unfaithful to one's government; showing a lack of allegiance." }
        ];

        function App() {
            const [phase, setPhase] = useState('newspaper'); 
            const [currentScenarioIndex, setCurrentScenarioIndex] = useState(0);
            const [libertyMeter, setLibertyMeter] = useState(100);
            const [score, setScore] = useState(0);
            const [studentRewrite, setStudentRewrite] = useState("");
            const [showRewriteReveal, setShowRewriteReveal] = useState(false);
            
            const [sliderValue, setSliderValue] = useState(50);
            const [selectedTerm, setSelectedTerm] = useState(null);
            const [matchedPairs, setMatchedPairs] = useState([]); 
            const [finalReflection, setFinalReflection] = useState("");

            const currentScenario = scenarios[currentScenarioIndex];

            // --- Actions ---
            const handleTermClick = (id) => {
                if (matchedPairs.includes(id)) return;
                setSelectedTerm(id);
            };

            const handleDefClick = (id) => {
                if (matchedPairs.includes(id)) return;
                if (selectedTerm === id) {
                    setMatchedPairs([...matchedPairs, id]);
                    setSelectedTerm(null);
                } else {
                    setSelectedTerm(null);
                }
            };

            const submitVerdict = () => {
                const isGuiltyVerdict = sliderValue > 50;
                const isHistoricallyIllegal = currentScenario.historicalRuling === "Illegal";
                
                let points = 0;
                if (isGuiltyVerdict && isHistoricallyIllegal) points = 1;
                if (!isGuiltyVerdict && !isHistoricallyIllegal) points = 1; 
                
                setScore(s => s + points);
                
                if (isGuiltyVerdict) {
                    setLibertyMeter(prev => Math.max(0, prev + currentScenario.libertyImpact));
                }
                setPhase('result');
            };

            const nextCase = () => {
                if (currentScenarioIndex < scenarios.length - 1) {
                    setCurrentScenarioIndex(prev => prev + 1);
                    setSliderValue(50); 
                    setPhase('game');
                } else {
                    setPhase('levelup');
                }
            };

            const resetGame = () => {
                setPhase('newspaper');
                setCurrentScenarioIndex(0);
                setLibertyMeter(100);
                setScore(0);
                setSliderValue(50);
                setStudentRewrite("");
                setShowRewriteReveal(false);
                setMatchedPairs([]);
                setSelectedTerm(null);
                setFinalReflection("");
            };

            // --- Component Renders ---
            
            const Newspaper = () => (
                <div className="min-h-screen p-4 md:p-8 newspaper-container flex items-center justify-center">
                    <div className="max-w-4xl w-full bg-[#fffdf0] text-black shadow-2xl p-6 md:p-12 border-t-8 border-black">
                        <div className="text-center border-b-4 border-double border-black pb-4 mb-6">
                            <div className="text-xs font-bold uppercase tracking-[0.5em] mb-2 text-stone-600">May 16, 1918 • Late Edition • Price 2 Cents</div>
                            <h1 className="font-playfair text-6xl md:text-8xl font-black uppercase leading-none mb-2">The War Gazette</h1>
                            <div className="w-full h-1 bg-black mb-1"></div>
                            <div className="w-full h-0.5 bg-black"></div>
                        </div>

                        <div className="text-center mb-8">
                            <h2 className="font-playfair text-5xl md:text-6xl font-black uppercase leading-tight mb-2">Sedition Act Signed!</h2>
                            <h3 className="font-serif text-2xl italic text-stone-700">Criticism of Government Now Punishable by 20 Years in Prison</h3>
                        </div>

                        <div className="grid md:grid-cols-3 gap-8">
                            <div className="md:col-span-2">
                                <div className="text-lg leading-relaxed font-serif mb-6 text-justify">
                                    <p className="mb-4">
                                        Washington D.C. — In a move to protect the war effort, Congress has passed two sweeping laws. 
                                        The <strong className="font-sans">Espionage Act (1917)</strong> makes it a crime to willfully <span className="font-bold underline decoration-red-800">obstruct</span> military recruitment.
                                    </p>
                                    <p>
                                        The new <strong className="font-sans">Sedition Act (1918)</strong> goes further, forbidding any <span className="font-bold underline decoration-red-800">disloyal</span>, profane, scurrilous, or <span className="font-bold underline decoration-red-800">abusive</span> language about the United States government, its flag, or its armed forces.
                                    </p>
                                </div>

                                <div className="bg-red-50 border border-red-200 p-6 rounded-sm">
                                    <h4 className="font-bold text-red-900 uppercase tracking-wider text-sm mb-4 border-b border-red-200 pb-2">Judicial Qualification Task</h4>
                                    <p className="text-sm text-red-800 mb-4">
                                        Prove you can interpret the law. Match the term on the left to its correct legal definition on the right.
                                    </p>
                                    
                                    <div className="grid grid-cols-2 gap-4">
                                        <h5 className="font-bold text-xs uppercase text-stone-500 mb-2">Legal Term</h5>
                                        <h5 className="font-bold text-xs uppercase text-stone-500 mb-2">Definition</h5>
                                        
                                        {vocabTerms.map((termItem, index) => {
                                            const defItem = vocabDefinitions[index];
                                            return (
                                                <React.Fragment key={termItem.id}>
                                                    <div 
                                                        onClick={() => handleTermClick(termItem.id)}
                                                        className={`p-3 border-2 rounded text-sm font-bold text-center flex items-center justify-center h-full cursor-pointer
                                                            ${matchedPairs.includes(termItem.id) ? 'term-matched' : 'term-card bg-white border-stone-300'}
                                                            ${selectedTerm === termItem.id ? 'term-selected' : ''}
                                                        `}
                                                    >
                                                        {termItem.term} {matchedPairs.includes(termItem.id) && "✓"}
                                                    </div>

                                                    <div 
                                                        onClick={() => handleDefClick(defItem.id)}
                                                        className={`p-3 border-2 rounded text-xs leading-tight flex items-center h-full cursor-pointer
                                                            ${matchedPairs.includes(defItem.id) ? 'term-matched' : 'term-card bg-white border-stone-300'}
                                                        `}
                                                    >
                                                        {defItem.text}
                                                    </div>
                                                </React.Fragment>
                                            );
                                        })}
                                    </div>
                                </div>

                                {matchedPairs.length === 3 ? (
                                    <div className="animate-fade-in mt-8 text-center">
                                        <p className="font-bold text-green-800 mb-2">✓ QUALIFICATION COMPLETE</p>
                                        <button 
                                            onClick={() => setPhase('intro')}
                                            className="bg-black text-white text-xl font-bold px-8 py-4 uppercase hover:bg-stone-800 transition shadow-lg w-full"
                                        >
                                            Take Judicial Oath & Begin &rarr;
                                        </button>
                                    </div>
                                ) : (
                                    <div className="mt-8 text-center text-stone-400 font-bold italic text-sm">
                                        Match all 3 terms to proceed...
                                    </div>
                                )}
                            </div>

                            <div className="md:col-span-1 border-l-2 border-stone-300 pl-8 hidden md:block">
                                <div className="mb-6">
                                    <h4 className="font-sans font-bold uppercase border-b-2 border-black mb-2">The Justification</h4>
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Thomas_Watt_Gregory_1913.jpg/480px-Thomas_Watt_Gregory_1913.jpg" className="w-full grayscale mb-2 sepia opacity-80" alt="Attorney General" />
                                    <p className="text-xs text-stone-500 mb-2">Attorney General Thomas Gregory</p>
                                    <blockquote className="font-serif italic text-lg leading-tight">
                                        "May God have mercy on them, for they need expect none from an outraged people and an <span className="font-bold">avenging government</span>."
                                    </blockquote>
                                </div>
                                <div className="bg-stone-200 p-4 text-center mt-8">
                                    <h5 className="font-bold uppercase text-sm mb-2">Liberty Bonds</h5>
                                    <div className="text-4xl font-black mb-1">100%</div>
                                    <div className="text-xs">Americanism Required</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );

            const Intro = () => (
                <div className="flex flex-col items-center justify-center min-h-screen text-center p-8 bg-vintage-pattern font-courier text-stone-900 animate-fade-in">
                    <div className="vintage-paper p-12 max-w-2xl transform rotate-1 rounded-sm shadow-2xl">
                        <h1 className="font-playfair text-4xl mb-4 text-stone-800 uppercase tracking-widest border-b-4 border-black pb-2">Judicial Orders</h1>
                        <div className="mb-6">
                            <span className="bg-black text-white px-3 py-1 text-sm font-bold uppercase">Authorized Personnel Only</span>
                        </div>
                        <p className="text-lg leading-relaxed mb-6 text-left">
                            You have reviewed the Sedition Act. As a newly appointed Federal Judge, your duty is to enforce these laws without hesitation.
                        </p>
                        <p className="italic text-sm mb-8 text-stone-600">Listen to the arguments. Weigh the security of the nation against the liberty of the individual.</p>
                        <button 
                            onClick={() => setPhase('game')}
                            className="bg-red-900 text-amber-50 px-8 py-3 text-xl font-bold uppercase hover:bg-red-800 transition shadow-lg border-2 border-black cursor-pointer"
                        >
                            Enter the Courtroom
                        </button>
                    </div>
                </div>
            );

            const Meter = () => (
                <div className="fixed top-4 right-4 z-10 w-64 vintage-paper p-3 border-2 border-black shadow-xl hidden md:block font-courier">
                    <div className="flex justify-between text-xs font-bold uppercase mb-1">
                        <span>Totalitarianism</span>
                        <span>Anarchy</span>
                    </div>
                    <div className="text-center font-bold text-lg mb-1 font-playfair">LIBERTY METER</div>
                    <div className="w-full bg-stone-300 h-6 border border-black relative">
                        <div 
                            className={`h-full transition-all duration-1000 ${libertyMeter > 50 ? 'bg-green-700' : 'bg-red-700'}`} 
                            style={{ width: `${libertyMeter}%` }}
                        ></div>
                    </div>
                    <div className="text-xs text-center mt-1 text-stone-600">{libertyMeter}% Civil Liberties Remaining</div>
                </div>
            );

            const GameScreen = () => (
                <div className="min-h-screen flex items-center justify-center py-12 px-4 relative bg-vintage-pattern font-courier text-stone-900">
                    <Meter />
                    <div className="vintage-paper max-w-6xl w-full p-4 md:p-8 relative min-h-[600px] flex flex-col shadow-2xl">
                        <div className="border-b-2 border-black pb-4 mb-6 flex flex-wrap justify-between items-end gap-2">
                            <div>
                                <h2 className="text-sm uppercase tracking-widest text-stone-500">Case File #{currentScenario.id}</h2>
                                <h1 className="text-3xl font-playfair font-bold">{currentScenario.title}</h1>
                                <h2 className="text-lg italic font-serif text-stone-600">{currentScenario.subTitle}</h2>
                            </div>
                            <div className="text-right">
                                <div className="text-4xl font-black font-playfair opacity-20">VS</div>
                            </div>
                        </div>

                        <div className="grid md:grid-cols-3 gap-8 flex-grow">
                            {/* Left: Defense */}
                            <div className="bg-white p-4 border-l-4 border-blue-800 shadow-sm flex flex-col">
                                <h3 className="font-bold text-blue-900 mb-2 uppercase tracking-wide border-b border-blue-200 pb-1">Defense Argument</h3>
                                <p className="font-serif text-lg leading-relaxed flex-grow italic">"{currentScenario.defense}"</p>
                            </div>

                            {/* Center: Interaction */}
                            <div className="flex flex-col items-center justify-center space-y-4 bg-stone-100 p-6 border border-stone-300 rounded-sm">
                                <div className="w-full mb-2">
                                    <img 
                                        src={currentScenario.img} 
                                        alt={currentScenario.title} 
                                        className="w-full max-h-64 object-contain mx-auto shadow-md border-2 border-stone-400" 
                                    />
                                </div>

                                <div className="text-center w-full">
                                    <h4 className="font-bold uppercase text-xs tracking-widest text-stone-500 mb-2">Context</h4>
                                    <p className="text-sm mb-4">{currentScenario.context}</p>
                                    
                                    <div className="bg-stone-200 p-3 mb-4 border-l-4 border-stone-500 text-left">
                                        <h4 className="font-bold uppercase text-xs tracking-widest text-stone-600 mb-1">Official Charges:</h4>
                                        <p className="text-sm font-bold text-red-900">{currentScenario.charges}</p>
                                    </div>
                                </div>

                                <div className="w-full">
                                    <h4 className="font-bold uppercase text-xs tracking-widest text-center mb-4">Jurisprudence Scale</h4>
                                    <div className="relative pt-6 pb-2">
                                        <div className="flex justify-between text-xs font-bold uppercase mb-2">
                                            <span className="text-blue-800">Protected Speech</span>
                                            <span className="text-red-800">Criminal Sedition</span>
                                        </div>
                                        <input 
                                            type="range" 
                                            min="0" 
                                            max="100" 
                                            value={sliderValue} 
                                            onChange={(e) => setSliderValue(Number(e.target.value))}
                                            className="w-full h-3 bg-gradient-to-r from-blue-200 via-stone-300 to-red-200 rounded-lg appearance-none cursor-pointer border border-stone-400 slider-thumb"
                                        />
                                        <div className="flex justify-center mt-2">
                                            <span className="font-bold font-playfair text-xl">
                                                {sliderValue < 40 ? "RULING: LEGAL" : sliderValue > 60 ? "RULING: ILLEGAL" : "UNDECIDED"}
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <button 
                                    onClick={submitVerdict}
                                    className="w-full bg-black text-white py-3 font-bold uppercase tracking-widest hover:bg-stone-800 shadow-lg border-2 border-transparent hover:border-black transition"
                                >
                                    Deliver Verdict
                                </button>
                            </div>

                            {/* Right: Prosecution */}
                            <div className="bg-white p-4 border-r-4 border-red-800 shadow-sm flex flex-col text-right">
                                <h3 className="font-bold text-red-900 mb-2 uppercase tracking-wide border-b border-red-200 pb-1">Prosecution Argument</h3>
                                <p className="font-serif text-lg leading-relaxed flex-grow italic">"{currentScenario.prosecution}"</p>
                            </div>
                        </div>
                    </div>
                </div>
            );

            const ResultScreen = () => (
                <div className="min-h-screen flex items-center justify-center py-12 px-4 relative bg-vintage-pattern font-courier text-stone-900">
                    <Meter />
                    <div className="vintage-paper max-w-3xl w-full p-8 relative flex flex-col shadow-2xl animate-fade-in border-4 border-double border-stone-600">
                        <div className="text-center mb-6">
                            <h2 className="text-sm uppercase tracking-widest text-stone-500 mb-2">Historical Reality Check</h2>
                            <h1 className="font-playfair text-4xl font-bold mb-4">{currentScenario.title}</h1>
                            <div className={`inline-block px-6 py-2 border-4 text-2xl font-black uppercase transform -rotate-2 ${
                                currentScenario.historicalRuling === 'Illegal' ? 'border-red-800 text-red-800' : 'border-green-800 text-green-800'
                            }`}>
                                Verdict: {currentScenario.historicalRuling}
                            </div>
                        </div>

                        <div className="bg-white p-6 border border-stone-300 shadow-inner mb-6">
                            <h3 className="font-bold uppercase text-xs mb-2 text-stone-400">The Outcome</h3>
                            <p className="text-lg font-serif mb-4">{currentScenario.outcome}</p>
                            <h3 className="font-bold uppercase text-xs mb-2 text-stone-400">Legal Reasoning</h3>
                            <p className="text-md leading-relaxed">{currentScenario.reasoning}</p>
                        </div>

                        <div className="flex justify-between items-center bg-stone-200 p-4 mb-6">
                            <div className="text-sm">
                                <strong>Your Ruling:</strong> {sliderValue < 50 ? "Protected Speech" : "Criminal Sedition"}
                            </div>
                            <div className="text-sm">
                                <strong>Match:</strong> {((sliderValue > 50 && currentScenario.historicalRuling === 'Illegal') || (sliderValue <= 50 && currentScenario.historicalRuling !== 'Illegal')) ? "Yes (+1 Score)" : "No"}
                            </div>
                        </div>

                        <button 
                            onClick={nextCase}
                            className="w-full bg-black text-white py-4 font-bold uppercase hover:bg-stone-800 shadow-lg"
                        >
                            Next Case &rarr;
                        </button>
                    </div>
                </div>
            );

            const LevelUp = () => (
                <div className="min-h-screen flex items-center justify-center py-12 px-4 bg-vintage-pattern font-courier text-stone-900">
                    <div className="vintage-paper max-w-3xl w-full p-10 shadow-2xl">
                        <div className="flex justify-between items-center mb-6 border-b-2 border-black pb-4">
                            <h1 className="font-playfair text-4xl">Final Verdict</h1>
                            <div className="text-right">
                                <p className="text-sm font-bold">ACCURACY SCORE</p>
                                <p className="text-2xl">{score} / {scenarios.length}</p>
                            </div>
                        </div>

                        <div className="mb-8">
                            <p className="text-lg mb-4">
                                In <em>Schenck v. United States</em>, Justice Oliver Wendell Holmes Jr. created the 
                                <strong> "Clear and Present Danger"</strong> test.
                            </p>
                            <div className="bg-stone-200 p-6 border-l-4 border-red-800 mb-6">
                                <h3 className="font-bold text-red-900 mb-2">FINAL CHALLENGE:</h3>
                                <p>Rewrite the "Clear and Present Danger" standard in your own words. How would you explain to a 9th grader when the government is allowed to stop someone from speaking?</p>
                            </div>

                            <textarea 
                                className="w-full p-4 bg-white border-2 border-stone-400 font-handwriting text-lg shadow-inner focus:outline-none focus:border-black transition"
                                rows="4"
                                placeholder="Start typing here... For example: Speech should only be illegal if..."
                                value={studentRewrite}
                                onChange={(e) => setStudentRewrite(e.target.value)}
                            ></textarea>
                        </div>

                        {!showRewriteReveal ? (
                            <button 
                                onClick={() => setShowRewriteReveal(true)}
                                disabled={studentRewrite.length < 10}
                                className="bg-blue-900 text-white px-8 py-3 font-bold disabled:opacity-50 hover:bg-blue-800 cursor-pointer"
                            >
                                Submit & Compare
                            </button>
                        ) : (
                            <div className="animate-fade-in mt-6">
                                <h3 className="font-bold text-stone-500 text-sm uppercase mb-2">Original Text (Justice Holmes):</h3>
                                <div className="bg-white p-6 border border-stone-300 font-serif italic mb-6">
                                    "The question in every case is whether the words used are used in such circumstances and are of such a nature as to create a <strong>clear and present danger</strong> that they will bring about the substantive evils that Congress has a right to prevent."
                                </div>
                                <div className="bg-green-100 p-4 border border-green-600 text-green-900 mb-6">
                                    <strong>Teacher Feedback:</strong> Excellent work. Notice how vague "substantive evils" is? This ambiguity allowed the government to arrest many people during WWI who simply disagreed with the war.
                                </div>
                                <button 
                                    onClick={() => setPhase('reflection')}
                                    className="w-full bg-black text-white text-xl font-bold px-8 py-4 uppercase hover:bg-stone-800 transition shadow-lg"
                                >
                                    Next: Final Reflection &rarr;
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );

            const Reflection = () => (
                <div className="min-h-screen flex items-center justify-center py-12 px-4 bg-vintage-pattern font-courier text-stone-900">
                    <div className="vintage-paper max-w-3xl w-full p-10 shadow-2xl">
                        <h1 className="font-playfair text-4xl mb-6 border-b-2 border-black pb-4 text-center">Final Reflection</h1>
                        <div className="mb-6 flex justify-center">
                            <div className="border-4 border-stone-800 p-2 bg-white transform -rotate-1">
                                <img 
                                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Rogers_-_Must_Liberty%27s_Light_Go_Out.jpg/470px-Rogers_-_Must_Liberty%27s_Light_Go_Out.jpg" 
                                    alt="Political Cartoon: Must Liberty's Light Go Out?" 
                                    className="max-h-[300px] object-contain sepia"
                                />
                                <p className="text-center text-xs mt-2 italic text-stone-500">
                                    "Must Liberty's Light Go Out?" (W.A. Rogers, 1917)
                                </p>
                            </div>
                        </div>

                        <div className="mb-8">
                            <div className="bg-stone-200 p-6 border-l-4 border-black mb-6">
                                <h3 className="font-bold text-stone-900 mb-2 uppercase">Your Opinion:</h3>
                                <p className="font-serif text-lg leading-relaxed">
                                    Based on what you've seen today (The Espionage Act, The Sedition Act, and the imprisonment of dissenters), answer the following:
                                </p>
                                <p className="font-bold mt-2">
                                    Should the government be allowed to infringe on civil liberties like freedom of speech during times of crisis? Why or why not?
                                </p>
                            </div>

                            <textarea 
                                className="w-full p-4 bg-white border-2 border-stone-400 font-handwriting text-lg shadow-inner focus:outline-none focus:border-black transition"
                                rows="6"
                                placeholder="Write your reflection here..."
                                value={finalReflection}
                                onChange={(e) => setFinalReflection(e.target.value)}
                            ></textarea>
                        </div>

                        <button 
                            onClick={resetGame}
                            disabled={finalReflection.length < 10}
                            className="w-full bg-red-900 text-white text-xl font-bold px-8 py-4 uppercase hover:bg-red-800 transition shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            Submit & Finish Simulation
                        </button>
                    </div>
                </div>
            );

            return (
                <div className="w-full h-full">
                    {phase === 'newspaper' && <Newspaper />}
                    {phase === 'intro' && <Intro />}
                    {phase === 'game' && <GameScreen />}
                    {phase === 'result' && <ResultScreen />}
                    {phase === 'levelup' && <LevelUp />}
                    {phase === 'reflection' && <Reflection />}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
  .term-card {
    transition: all 0.2s;
    cursor: pointer;
  }
  .term-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }
  .term-selected {
    background-color: #fee2e2;
    border-color: #b91c1c;
    transform: scale(1.02);
  }
  .term-matched {
    background-color: #dcfce7;
    border-color: #15803d;
    color: #14532d;
    cursor: default;
  }
`;

// --- Case Data ---
const scenarios = [
  {
    id: 1,
    title: "Eugene V. Debs",
    subTitle: "The Canton Speech",
    img: "Case1.png",
    context: "Eugene V. Debs, a five-time presidential candidate for the Socialist Party, traveled to Canton, Ohio to visit three fellow socialists in prison. He delivered a fiery speech to a crowd of 1,200 in a public park. In it, he carefully avoided directly inciting violence, but heavily criticized the U.S. government, the draft, and the war as a capitalist venture, famously stating the 'master class' declares wars while the 'subject class' fights them.",
    charges: "Charged with 10 counts of violating the Espionage Act for 'attempting to cause insubordination in the military' and 'obstructing recruitment'.",
    prosecution: "He is obstructing recruitment! He told the crowd they are 'fit for something better than cannon fodder.' This discourages young men from enlisting. He is a danger to our military success.",
    defense: "He never explicitly told anyone to break the law. He is critiquing capitalism and war in general. The First Amendment protects political dissent, especially during wartime when we need it most.",
    historicalRuling: "Illegal",
    outcome: "Sentenced to 10 years in prison.",
    reasoning: "The Supreme Court upheld the conviction. They argued his words had the 'natural tendency' to obstruct the draft.",
    libertyImpact: -15
  },
  {
    id: 2,
    title: "The Hofer Brothers",
    subTitle: "The Hutterite Martyrs",
    img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/63/Hutterites.jpg/640px-Hutterites.jpg", // Generic Hutterite representation
    context: "Joseph and Michael Hofer were Hutterites, a Christian sect living in communal colonies in South Dakota who believe in absolute pacifism. When drafted, they reported to camp but refused to wear military uniforms, pick up weapons, or even perform non-combat work, believing any support of the 'war machine' violated Jesus's teachings. Their refusal was seen not just as religious devotion, but as defiance of federal law.",
    charges: "Court-martialed for 'disobeying lawful orders' from a superior officer under the Articles of War.",
    prosecution: "A soldier cannot choose which orders to follow. Refusing to wear the uniform is insubordination. If we allow this, discipline in the entire army crumbles.",
    defense: "These men are not spies; they are religious pacifists. They have lived in America for peace. Forcing them to violate their conscience and religion is tyranny, not defense.",
    historicalRuling: "Illegal",
    outcome: "Court-martialed and sent to Alcatraz/Leavenworth. Two brothers died from mistreatment.",
    reasoning: "The military viewed conscientious objection as a crime equivalent to desertion or sedition during the war crisis.",
    libertyImpact: -25
  },
  {
    id: 3,
    title: "Emma Goldman",
    subTitle: "No Conscription League",
    img: "https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Emma_Goldman_standing_on_a_street_car_1916.jpg/470px-Emma_Goldman_standing_on_a_street_car_1916.jpg",
    context: "Emma Goldman, a fierce anarchist, launched the 'No Conscription League' to oppose the draft, which she called a violation of the 13th Amendment's ban on involuntary servitude. At massive rallies in New York, she stopped short of telling men to dodge the draft directly, but handed out manifestos arguing that conscription was 'the cemetery of liberty' and that citizens had a moral right to resist.",
    charges: "Charged with 'conspiracy to induce persons not to register' for the draft under the Selective Service Act.",
    prosecution: "She is organizing a conspiracy to induce men not to register! She calls the draft 'state tyranny.' This is a direct attempt to sabotage the Selective Service Act.",
    defense: "She is expressing an opinion on a law. She believes the draft violates the 13th Amendment (involuntary servitude). This is protected political speech, not a physical blockade.",
    historicalRuling: "Illegal",
    outcome: "Sentenced to 2 years, fined $10,000, and deported to Russia.",
    reasoning: "The court ruled that organizing to counsel others to break the law is not protected speech.",
    libertyImpact: -20
  },
  {
    id: 4,
    title: "Charles Schenck",
    subTitle: "The Pamphleteer",
    img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Schenck_v._United_States_pamphlet.jpg/480px-Schenck_v._United_States_pamphlet.jpg",
    context: "Charles Schenck was the General Secretary of the Socialist Party in Philadelphia. To protest the draft, he printed 15,000 leaflets titled 'Long Live the Constitution of the United States.' These were mailed directly to men who had just been drafted. The pamphlets didn't call for violence, but urged men to 'assert your rights' and resist the 'intimidation' of the draft board, comparing a conscript to a convict.",
    charges: "Charged with 'conspiracy to violate the Espionage Act' by causing insubordination in the military and obstructing recruitment.",
    prosecution: "He targeted draftees specifically! This isn't just a speech; it's an attempt to cause insubordination in the military. It creates a 'Clear and Present Danger'.",
    defense: "The pamphlet only urged peaceful resistance and repeal of the act. It quoted the Constitution! If we can't quote the Constitution during war, do we have a Constitution?",
    historicalRuling: "Illegal",
    outcome: "Conviction upheld by Supreme Court (9-0).",
    reasoning: "Justice Holmes created the 'Clear and Present Danger' test. Free speech does not protect a man falsely shouting fire in a theater.",
    libertyImpact: -20
  },
  {
    id: 5,
    title: "Robert Goldstein",
    subTitle: "The Spirit of '76",
    img: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Spirit_of_76_poster.jpg/480px-Spirit_of_76_poster.jpg",
    context: "Robert Goldstein produced a lavish silent film, 'The Spirit of '76', depicting the American Revolution. The movie included historically accurate but violent scenes of British soldiers bayoneting women and children during the Wyoming Valley Massacre. However, because the U.S. had just entered WWI as an *ally* of Britain, federal agents seized the film. They argued that showing British atrocities—even from 140 years ago—would incite hatred against an ally.",
    charges: "Charged with violating the Espionage Act for 'attempting to cause insubordination, mutiny, and refusal of duty' in the military.",
    prosecution: "This film sows discord! The British are now our allies. Showing them as villains will make Americans hate them and help the Germans. It is enemy propaganda.",
    defense: "It's a historical movie about 1776! It depicts actual events. We cannot censor history just because our alliances have changed. This is art, not treason.",
    historicalRuling: "Illegal",
    outcome: "Sentenced to 10 years in federal prison.",
    reasoning: "The court ruled the film was 'calculated to foment disloyalty' and aid the German enemy by dividing the Allies.",
    libertyImpact: -30
  }
];

// --- Vocabulary Data ---
const vocabTerms = [
  { term: "Obstruct", id: "obstruct" },
  { term: "Disloyal", id: "disloyal" },
  { term: "Abusive", id: "abusive" }
];

const vocabDefinitions = [
  { id: "abusive", text: "Extremely offensive, insulting, or harmful language." },
  { id: "obstruct", text: "To intentionally block, stop, or delay an action (like recruitment)." },
  { id: "disloyal", text: "Unfaithful to one's government; showing a lack of allegiance." }
];

export default function App() {
  const [phase, setPhase] = useState('newspaper'); // newspaper, intro, game, result, levelup, reflection
  const [currentScenarioIndex, setCurrentScenarioIndex] = useState(0);
  const [libertyMeter, setLibertyMeter] = useState(100);
  const [score, setScore] = useState(0);
  const [studentRewrite, setStudentRewrite] = useState("");
  const [showRewriteReveal, setShowRewriteReveal] = useState(false);
  
  // Game state
  const [sliderValue, setSliderValue] = useState(50);
  
  // Newspaper Matching State
  const [selectedTerm, setSelectedTerm] = useState(null);
  const [matchedPairs, setMatchedPairs] = useState([]); // Array of ids
  
  // Reflection state
  const [finalReflection, setFinalReflection] = useState("");

  const currentScenario = scenarios[currentScenarioIndex];

  // --- Actions ---

  const handleTermClick = (id) => {
    if (matchedPairs.includes(id)) return;
    setSelectedTerm(id);
  };

  const handleDefClick = (id) => {
    if (matchedPairs.includes(id)) return;
    
    if (selectedTerm === id) {
      // Match found!
      setMatchedPairs([...matchedPairs, id]);
      setSelectedTerm(null);
    } else {
      // Wrong match
      // Optional: Add visual error feedback here
      setSelectedTerm(null);
    }
  };

  const submitVerdict = () => {
    // 0-40: Protected, 41-59: Undecided/Gray, 60-100: Sedition
    // Simple logic: Is verdict > 50 (Guilty) matching history?
    const isGuiltyVerdict = sliderValue > 50;
    const isHistoricallyIllegal = currentScenario.historicalRuling === "Illegal";
    
    let points = 0;
    if (isGuiltyVerdict && isHistoricallyIllegal) points = 1;
    if (!isGuiltyVerdict && !isHistoricallyIllegal) points = 1; 
    
    setScore(s => s + points);
    
    // Meter impact
    if (isGuiltyVerdict) {
        setLibertyMeter(prev => Math.max(0, prev + currentScenario.libertyImpact));
    }

    setPhase('result');
  };

  const nextCase = () => {
    if (currentScenarioIndex < scenarios.length - 1) {
      setCurrentScenarioIndex(prev => prev + 1);
      setSliderValue(50); // Reset slider
      setPhase('game');
    } else {
      setPhase('levelup');
    }
  };

  const resetGame = () => {
    setPhase('newspaper');
    setCurrentScenarioIndex(0);
    setLibertyMeter(100);
    setScore(0);
    setSliderValue(50);
    setStudentRewrite("");
    setShowRewriteReveal(false);
    setMatchedPairs([]);
    setSelectedTerm(null);
    setFinalReflection("");
  };

  // --- Components ---

  const Newspaper = () => (
    <div className="min-h-screen p-4 md:p-8 newspaper-container flex items-center justify-center">
      <div className="max-w-4xl w-full bg-[#fffdf0] text-black shadow-2xl p-6 md:p-12 border-t-8 border-black">
        <div className="text-center border-b-4 border-double border-black pb-4 mb-6">
          <div className="text-xs font-bold uppercase tracking-[0.5em] mb-2 text-stone-600">May 16, 1918 • Late Edition • Price 2 Cents</div>
          <h1 className="font-playfair text-6xl md:text-8xl font-black uppercase leading-none mb-2">The War Gazette</h1>
          <div className="w-full h-1 bg-black mb-1"></div>
          <div className="w-full h-0.5 bg-black"></div>
        </div>

        <div className="text-center mb-8">
          <h2 className="font-playfair text-5xl md:text-6xl font-black uppercase leading-tight mb-2">Sedition Act Signed!</h2>
          <h3 className="font-serif text-2xl italic text-stone-700">Criticism of Government Now Punishable by 20 Years in Prison</h3>
        </div>

        <div className="grid md:grid-cols-3 gap-8">
          <div className="md:col-span-2">
            
            <div className="text-lg leading-relaxed font-serif mb-6 text-justify">
              <p className="mb-4">
                Washington D.C. — In a move to protect the war effort, Congress has passed two sweeping laws. 
                The <strong className="font-sans">Espionage Act (1917)</strong> makes it a crime to willfully <span className="font-bold underline decoration-red-800">obstruct</span> military recruitment.
              </p>
              <p>
                The new <strong className="font-sans">Sedition Act (1918)</strong> goes further, forbidding any <span className="font-bold underline decoration-red-800">disloyal</span>, profane, scurrilous, or <span className="font-bold underline decoration-red-800">abusive</span> language about the United States government, its flag, or its armed forces.
              </p>
            </div>

            <div className="bg-red-50 border border-red-200 p-6 rounded-sm">
              <h4 className="font-bold text-red-900 uppercase tracking-wider text-sm mb-4 border-b border-red-200 pb-2">Judicial Qualification Task</h4>
              <p className="text-sm text-red-800 mb-4">
                Prove you can interpret the law. Match the term on the left to its correct legal definition on the right.
              </p>
              
              <div className="grid grid-cols-2 gap-4">
                  <h5 className="font-bold text-xs uppercase text-stone-500 mb-2">Legal Term</h5>
                  <h5 className="font-bold text-xs uppercase text-stone-500 mb-2">Definition</h5>
                  
                  {vocabTerms.map((termItem, index) => {
                    const defItem = vocabDefinitions[index];
                    return (
                      <React.Fragment key={termItem.id}>
                        {/* Term */}
                        <div 
                          onClick={() => handleTermClick(termItem.id)}
                          className={`p-3 border-2 rounded text-sm font-bold text-center flex items-center justify-center h-full cursor-pointer
                            ${matchedPairs.includes(termItem.id) ? 'term-matched' : 'term-card bg-white border-stone-300'}
                            ${selectedTerm === termItem.id ? 'term-selected' : ''}
                          `}
                        >
                          {termItem.term} {matchedPairs.includes(termItem.id) && "✓"}
                        </div>

                        {/* Definition */}
                        <div 
                          onClick={() => handleDefClick(defItem.id)}
                          className={`p-3 border-2 rounded text-xs leading-tight flex items-center h-full cursor-pointer
                            ${matchedPairs.includes(defItem.id) ? 'term-matched' : 'term-card bg-white border-stone-300'}
                          `}
                        >
                          {defItem.text}
                        </div>
                      </React.Fragment>
                    );
                  })}
              </div>
            </div>

            {matchedPairs.length === 3 ? (
              <div className="animate-fade-in mt-8 text-center">
                <p className="font-bold text-green-800 mb-2">✓ QUALIFICATION COMPLETE</p>
                <button 
                  onClick={() => setPhase('intro')}
                  className="bg-black text-white text-xl font-bold px-8 py-4 uppercase hover:bg-stone-800 transition shadow-lg w-full"
                >
                  Take Judicial Oath & Begin &rarr;
                </button>
              </div>
            ) : (
              <div className="mt-8 text-center text-stone-400 font-bold italic text-sm">
                Match all 3 terms to proceed...
              </div>
            )}
          </div>

          <div className="md:col-span-1 border-l-2 border-stone-300 pl-8 hidden md:block">
            <div className="mb-6">
              <h4 className="font-sans font-bold uppercase border-b-2 border-black mb-2">The Justification</h4>
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Thomas_Watt_Gregory_1913.jpg/480px-Thomas_Watt_Gregory_1913.jpg" className="w-full grayscale mb-2 sepia opacity-80" alt="Attorney General" />
              <p className="text-xs text-stone-500 mb-2">Attorney General Thomas Gregory</p>
              <blockquote className="font-serif italic text-lg leading-tight">
                "May God have mercy on them, for they need expect none from an outraged people and an <span className="font-bold">avenging government</span>."
              </blockquote>
            </div>
            
            <div className="bg-stone-200 p-4 text-center mt-8">
              <h5 className="font-bold uppercase text-sm mb-2">Liberty Bonds</h5>
              <div className="text-4xl font-black mb-1">100%</div>
              <div className="text-xs">Americanism Required</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );

  const Intro = () => (
    <div className="flex flex-col items-center justify-center min-h-screen text-center p-8 bg-vintage-pattern font-courier text-stone-900 animate-fade-in">
      <div className="vintage-paper p-12 max-w-2xl transform rotate-1 rounded-sm shadow-2xl">
        <h1 className="font-playfair text-4xl mb-4 text-stone-800 uppercase tracking-widest border-b-4 border-black pb-2">Judicial Orders</h1>
        <div className="mb-6">
            <span className="bg-black text-white px-3 py-1 text-sm font-bold uppercase">Authorized Personnel Only</span>
        </div>
        <p className="text-lg leading-relaxed mb-6 text-left">
          You have reviewed the Sedition Act. As a newly appointed Federal Judge, your duty is to enforce these laws without hesitation.
        </p>
        <p className="italic text-sm mb-8 text-stone-600">Listen to the arguments. Weigh the security of the nation against the liberty of the individual.</p>
        <button 
          onClick={() => setPhase('game')}
          className="bg-red-900 text-amber-50 px-8 py-3 text-xl font-bold uppercase hover:bg-red-800 transition shadow-lg border-2 border-black cursor-pointer"
        >
          Enter the Courtroom
        </button>
      </div>
    </div>
  );

  const Meter = () => (
    <div className="fixed top-4 right-4 z-10 w-64 vintage-paper p-3 border-2 border-black shadow-xl hidden md:block font-courier">
      <div className="flex justify-between text-xs font-bold uppercase mb-1">
        <span>Totalitarianism</span>
        <span>Anarchy</span>
      </div>
      <div className="text-center font-bold text-lg mb-1 font-playfair">LIBERTY METER</div>
      <div className="w-full bg-stone-300 h-6 border border-black relative">
        <div 
          className={`h-full transition-all duration-1000 ${libertyMeter > 50 ? 'bg-green-700' : 'bg-red-700'}`} 
          style={{ width: `${libertyMeter}%` }}
        ></div>
      </div>
      <div className="text-xs text-center mt-1 text-stone-600">{libertyMeter}% Civil Liberties Remaining</div>
    </div>
  );

  const GameScreen = () => (
    <div className="min-h-screen flex items-center justify-center py-12 px-4 relative bg-vintage-pattern font-courier text-stone-900">
      <Meter />
      
      <div className="vintage-paper max-w-6xl w-full p-4 md:p-8 relative min-h-[600px] flex flex-col shadow-2xl">
        {/* Header */}
        <div className="border-b-2 border-black pb-4 mb-6 flex flex-wrap justify-between items-end gap-2">
          <div>
            <h2 className="text-sm uppercase tracking-widest text-stone-500">Case File #{currentScenario.id}</h2>
            <h1 className="text-3xl font-playfair font-bold">{currentScenario.title}</h1>
            <h2 className="text-lg italic font-serif text-stone-600">{currentScenario.subTitle}</h2>
          </div>
          <div className="text-right">
             <div className="text-4xl font-black font-playfair opacity-20">VS</div>
          </div>
        </div>

        {/* Content Grid */}
        <div className="grid md:grid-cols-3 gap-8 flex-grow">
          
          {/* Left: Defense */}
          <div className="bg-white p-4 border-l-4 border-blue-800 shadow-sm flex flex-col">
            <h3 className="font-bold text-blue-900 mb-2 uppercase tracking-wide border-b border-blue-200 pb-1">Defense Argument</h3>
            <p className="font-serif text-lg leading-relaxed flex-grow italic">"{currentScenario.defense}"</p>
          </div>

          {/* Center: Judge's Desk (Interaction) */}
          <div className="flex flex-col items-center justify-center space-y-4 bg-stone-100 p-6 border border-stone-300 rounded-sm">
             {/* Main Visual - Now Central */}
             <div className="w-full mb-2">
                <img 
                    src={currentScenario.img} 
                    alt={currentScenario.title} 
                    className="w-full max-h-64 object-contain mx-auto shadow-md border-2 border-stone-400" 
                />
             </div>

             <div className="text-center w-full">
                <h4 className="font-bold uppercase text-xs tracking-widest text-stone-500 mb-2">Context</h4>
                <p className="text-sm mb-4">{currentScenario.context}</p>
                
                <div className="bg-stone-200 p-3 mb-4 border-l-4 border-stone-500 text-left">
                    <h4 className="font-bold uppercase text-xs tracking-widest text-stone-600 mb-1">Official Charges:</h4>
                    <p className="text-sm font-bold text-red-900">{currentScenario.charges}</p>
                </div>
             </div>

             <div className="w-full">
                <h4 className="font-bold uppercase text-xs tracking-widest text-center mb-4">Jurisprudence Scale</h4>
                
                <div className="relative pt-6 pb-2">
                    <div className="flex justify-between text-xs font-bold uppercase mb-2">
                        <span className="text-blue-800">Protected Speech</span>
                        <span className="text-red-800">Criminal Sedition</span>
                    </div>
                    <input 
                        type="range" 
                        min="0" 
                        max="100" 
                        value={sliderValue} 
                        onChange={(e) => setSliderValue(Number(e.target.value))}
                        className="w-full h-3 bg-gradient-to-r from-blue-200 via-stone-300 to-red-200 rounded-lg appearance-none cursor-pointer border border-stone-400 slider-thumb"
                    />
                    <div className="flex justify-center mt-2">
                        <span className="font-bold font-playfair text-xl">
                            {sliderValue < 40 ? "RULING: LEGAL" : sliderValue > 60 ? "RULING: ILLEGAL" : "UNDECIDED"}
                        </span>
                    </div>
                </div>
             </div>

             <button 
                onClick={submitVerdict}
                className="w-full bg-black text-white py-3 font-bold uppercase tracking-widest hover:bg-stone-800 shadow-lg border-2 border-transparent hover:border-black transition"
             >
                Deliver Verdict
             </button>
          </div>

          {/* Right: Prosecution */}
          <div className="bg-white p-4 border-r-4 border-red-800 shadow-sm flex flex-col text-right">
            <h3 className="font-bold text-red-900 mb-2 uppercase tracking-wide border-b border-red-200 pb-1">Prosecution Argument</h3>
            <p className="font-serif text-lg leading-relaxed flex-grow italic">"{currentScenario.prosecution}"</p>
          </div>

        </div>
      </div>
    </div>
  );

  const ResultScreen = () => (
    <div className="min-h-screen flex items-center justify-center py-12 px-4 relative bg-vintage-pattern font-courier text-stone-900">
      <Meter />
      
      <div className="vintage-paper max-w-3xl w-full p-8 relative flex flex-col shadow-2xl animate-fade-in border-4 border-double border-stone-600">
        <div className="text-center mb-6">
             <h2 className="text-sm uppercase tracking-widest text-stone-500 mb-2">Historical Reality Check</h2>
             <h1 className="font-playfair text-4xl font-bold mb-4">{currentScenario.title}</h1>
             <div className={`inline-block px-6 py-2 border-4 text-2xl font-black uppercase transform -rotate-2 ${
                 currentScenario.historicalRuling === 'Illegal' ? 'border-red-800 text-red-800' : 'border-green-800 text-green-800'
             }`}>
                 Verdict: {currentScenario.historicalRuling}
             </div>
        </div>

        <div className="bg-white p-6 border border-stone-300 shadow-inner mb-6">
            <h3 className="font-bold uppercase text-xs mb-2 text-stone-400">The Outcome</h3>
            <p className="text-lg font-serif mb-4">{currentScenario.outcome}</p>
            
            <h3 className="font-bold uppercase text-xs mb-2 text-stone-400">Legal Reasoning</h3>
            <p className="text-md leading-relaxed">{currentScenario.reasoning}</p>
        </div>

        <div className="flex justify-between items-center bg-stone-200 p-4 mb-6">
             <div className="text-sm">
                <strong>Your Ruling:</strong> {sliderValue < 50 ? "Protected Speech" : "Criminal Sedition"}
             </div>
             <div className="text-sm">
                <strong>Match:</strong> {((sliderValue > 50 && currentScenario.historicalRuling === 'Illegal') || (sliderValue <= 50 && currentScenario.historicalRuling !== 'Illegal')) ? "Yes (+1 Score)" : "No"}
             </div>
        </div>

        <button 
            onClick={nextCase}
            className="w-full bg-black text-white py-4 font-bold uppercase hover:bg-stone-800 shadow-lg"
        >
            Next Case &rarr;
        </button>
      </div>
    </div>
  );

  const LevelUp = () => (
    <div className="min-h-screen flex items-center justify-center py-12 px-4 bg-vintage-pattern font-courier text-stone-900">
      <div className="vintage-paper max-w-3xl w-full p-10 shadow-2xl">
        <div className="flex justify-between items-center mb-6 border-b-2 border-black pb-4">
          <h1 className="font-playfair text-4xl">Final Verdict</h1>
          <div className="text-right">
            <p className="text-sm font-bold">ACCURACY SCORE</p>
            <p className="text-2xl">{score} / {scenarios.length}</p>
          </div>
        </div>

        <div className="mb-8">
          <p className="text-lg mb-4">
            In <em>Schenck v. United States</em>, Justice Oliver Wendell Holmes Jr. created the 
            <strong> "Clear and Present Danger"</strong> test.
          </p>
          <div className="bg-stone-200 p-6 border-l-4 border-red-800 mb-6">
            <h3 className="font-bold text-red-900 mb-2">FINAL CHALLENGE:</h3>
            <p>Rewrite the "Clear and Present Danger" standard in your own words. How would you explain to a 9th grader when the government is allowed to stop someone from speaking?</p>
          </div>

          <textarea 
            className="w-full p-4 bg-white border-2 border-stone-400 font-handwriting text-lg shadow-inner focus:outline-none focus:border-black transition"
            rows="4"
            placeholder="Start typing here... For example: Speech should only be illegal if..."
            value={studentRewrite}
            onChange={(e) => setStudentRewrite(e.target.value)}
          ></textarea>
        </div>

        {!showRewriteReveal ? (
          <button 
            onClick={() => setShowRewriteReveal(true)}
            disabled={studentRewrite.length < 10}
            className="bg-blue-900 text-white px-8 py-3 font-bold disabled:opacity-50 hover:bg-blue-800 cursor-pointer"
          >
            Submit & Compare
          </button>
        ) : (
          <div className="animate-fade-in mt-6">
            <h3 className="font-bold text-stone-500 text-sm uppercase mb-2">Original Text (Justice Holmes):</h3>
            <div className="bg-white p-6 border border-stone-300 font-serif italic mb-6">
              "The question in every case is whether the words used are used in such circumstances and are of such a nature as to create a <strong>clear and present danger</strong> that they will bring about the substantive evils that Congress has a right to prevent."
            </div>
            <div className="bg-green-100 p-4 border border-green-600 text-green-900 mb-6">
              <strong>Teacher Feedback:</strong> Excellent work. Notice how vague "substantive evils" is? This ambiguity allowed the government to arrest many people during WWI who simply disagreed with the war.
            </div>
            
            <button 
              onClick={() => setPhase('reflection')}
              className="w-full bg-black text-white text-xl font-bold px-8 py-4 uppercase hover:bg-stone-800 transition shadow-lg"
            >
              Next: Final Reflection &rarr;
            </button>
          </div>
        )}
      </div>
    </div>
  );

  const Reflection = () => (
    <div className="min-h-screen flex items-center justify-center py-12 px-4 bg-vintage-pattern font-courier text-stone-900">
      <div className="vintage-paper max-w-3xl w-full p-10 shadow-2xl">
        <h1 className="font-playfair text-4xl mb-6 border-b-2 border-black pb-4 text-center">Final Reflection</h1>
        
        <div className="mb-6 flex justify-center">
            {/* Placeholder for Liberty1.jnp - Using a relevant historical WWI censorship cartoon */}
            <div className="border-4 border-stone-800 p-2 bg-white transform -rotate-1">
                <img 
                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/Rogers_-_Must_Liberty%27s_Light_Go_Out.jpg/470px-Rogers_-_Must_Liberty%27s_Light_Go_Out.jpg" 
                    alt="Political Cartoon: Must Liberty's Light Go Out?" 
                    className="max-h-[300px] object-contain sepia"
                />
                <p className="text-center text-xs mt-2 italic text-stone-500">
                    "Must Liberty's Light Go Out?" (W.A. Rogers, 1917)
                </p>
            </div>
        </div>

        <div className="mb-8">
          <div className="bg-stone-200 p-6 border-l-4 border-black mb-6">
            <h3 className="font-bold text-stone-900 mb-2 uppercase">Your Opinion:</h3>
            <p className="font-serif text-lg leading-relaxed">
              Based on what you've seen today (The Espionage Act, The Sedition Act, and the imprisonment of dissenters), answer the following:
            </p>
            <p className="font-bold mt-2">
              Should the government be allowed to infringe on civil liberties like freedom of speech during times of crisis? Why or why not?
            </p>
          </div>

          <textarea 
            className="w-full p-4 bg-white border-2 border-stone-400 font-handwriting text-lg shadow-inner focus:outline-none focus:border-black transition"
            rows="6"
            placeholder="Write your reflection here..."
            value={finalReflection}
            onChange={(e) => setFinalReflection(e.target.value)}
          ></textarea>
        </div>

        <button 
          onClick={resetGame}
          disabled={finalReflection.length < 10}
          className="w-full bg-red-900 text-white text-xl font-bold px-8 py-4 uppercase hover:bg-red-800 transition shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Submit & Finish Simulation
        </button>
      </div>
    </div>
  );

  return (
    <>
      <style>{customStyles}</style>
      <div className="w-full h-full">
        {phase === 'newspaper' && <Newspaper />}
        {phase === 'intro' && <Intro />}
        {phase === 'game' && <GameScreen />}
        {phase === 'result' && <ResultScreen />}
        {phase === 'levelup' && <LevelUp />}
        {phase === 'reflection' && <Reflection />}
      </div>
    </>
  );
}
